# Malware-Analysis

## Objective

Eric Fischer from the Purchasing Department at Bartell Ltd has received an email from a known contact with a Word document attachment.  Upon opening the document, he accidentally clicked on "Enable Content."  The SOC Department immediately received an alert from the endpoint agent that Eric's workstation was making suspicious connections outbound. The pcap was retrieved from the network sensor and handed to you for analysis. 

### Skills Learned

- Monitoring & Detection Skills.
- Proficiency in analyzing and interpreting network logs.
- Ability to generate and recognize attack signatures and patterns.
- Enhanced knowledge of network protocols and security vulnerabilities.
- Development of critical thinking and problem-solving skills in cybersecurity.

### Tools Used

- Wireshark.


## Steps

~STEP 1: Find the date and time for the first HTTP connection to the malicious IP.

The objective is to find the time and date our malicious actor gained connection. I can filter out this packet by only viewing http data. By inserting http as a filter we can take a look at http data that can contain GET, POST, and OK responses.

![image](https://github.com/user-attachments/assets/d0e4590a-8f0e-41e5-9de5-ee34094aebc2) 

~Immediately, a http GET request is shown.

The first GET request was made to the designated destination IP: 85.187.128.24, where a zip file was downloaded. By correcting the time display format, I can accurately identify when the attacker first attempted a connection.

![image](https://github.com/user-attachments/assets/ae65efc2-f7aa-4e77-8f33-28c0f53dc489)

![image](https://github.com/user-attachments/assets/f3b884aa-14f9-4def-8dae-b990f90cce06) ~Date and time for the first HTTP connection to the malicious IP.

~STEP 2: Find the name of the zip file that was downloaded and the domain hosting the malicious zip file.

With the connectionâ€™s date and time now being identified, the same packet can give more information about what occurred by following the TCP stream. Since HTTP data uses TCP as its transport protocol, I can view the request and responses being made.

![image](https://github.com/user-attachments/assets/a891c274-3f38-4386-9023-faebcf71cb36)

From following the stream of the first packet, I can see the full stream conversation where I see the GET request of the file that was downloaded as well as the domain where the file was being hosted on. Downloaded File: documents.zip, Host: attirenepal.com

~STEP 3: Without downloading the file, find the name of the file in the zip file.
         Find the name and the version of the webserver of the malicious IP from which the zip file was downloaded.

The name of the malicious file used by the attacker is displayed in the same stream. Looking at the HTTP/1.1 OK status code gives the information.
![image](https://github.com/user-attachments/assets/b2c3afc1-0ab2-48a3-a029-2d85577b61fd)

Name of file in the zip file: chart-1530076591.x1s , Server and Version: LiteSpeed, PHP/7.2.34


~STEP 4: Find the domains that downloaded malicious files onto the victim workstation.


















